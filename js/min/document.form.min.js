function FileSize(e){return e>max_filesize?!1:!0}function FileType(e){switch(e){case"pdf":case"txt":case"doc":case"docx":case"ppt":case"pptx":case"xls":case"xlsx":case"zip":break;default:return!1}return!0}var max_filesize=$("#maximumSize").val(),api_document="api/document.php";$(document).ready(function(){$documentForm=$("#documentForm"),$filePreview=$("#filePreview"),$btnSubmit=$("#btnSubmit"),$fileName=$("#fileName"),$fileInput=$("#file"),$titleInput=$("#title"),$descriptionInput=$("#description"),$fileSizeInfo=$("#fileSizeInfo"),autosize($("textarea")),$fileSizeInfo.html("ขนาดไม่เกิน "+max_filesize/1048576+" MB"),$filePreview.click(function(){$fileInput.focus().click()}),$fileInput.change(function(){var e=this.files,i=e[0],t=i.size,a=i.name.substring(0,i.name.lastIndexOf(".")),n=i.name.substring(i.name.lastIndexOf(".")+1);return FileType(n)?FileSize(t)?($(".form-items").removeClass("hidden middle"),$fileName.html(i.name),$fileSizeInfo.html("ขนาด "+numeral(t).format("0.0 b")),$("#title").val(a),$("#title").focus(),$btnSubmit.removeClass("loading"),$btnSubmit.prop("disabled",!1),void 0):(alert("ไฟล์ของคุณมีขนาด "+numeral(t).format("0.0 b")+" ซึ่งต้องไม่เกิน "+max_filesize/1048576+" MB"),location.reload(),!1):(alert("ระบบยังไม่รองรับไฟล์ประเภท ."+n),location.reload(),!1)}),$documentForm.ajaxForm({beforeSubmit:function(e){var i=e[0].value.name,t=e[0].value.size,a=i.substring(i.lastIndexOf(".")+1),n=e[1].value,l=e[3].value;return FileSize(t)?FileType(a)?n&&l&&i?($btnSubmit.addClass("loading"),$btnSubmit.html('รอสักครู่<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>'),$btnSubmit.prop("disabled",!0),$fileInput.prop("disabled",!0),$titleInput.prop("disabled",!0),$descriptionInput.prop("disabled",!0),$progressbar.fadeIn(300),$progressbar.width("0%"),void 0):!1:!1:!1},uploadProgress:function(e,i,t,a){var n=a;n=80*n/100,$progressbar.animate({width:n+"%"},100)},success:function(){$progressbar.animate({width:"100%"},300)},complete:function(e){if(e.responseJSON){var i=e.responseJSON.file_id;setTimeout(function(){window.location="document/privacy/"+i},2e3)}else alert("ไฟล์ของคุณไม่สามารถอัพโหลดเข้าระบบได้ กรุณาติดต่อผู้ดูแลระบบ"),location.reload()}})});