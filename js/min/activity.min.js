var api_activity="api/activity.php";$(document).ready(function(){function t(){$(".edit-menu").hide()}var e,a=$("#activity_id").val();autosize($("textarea")),$dialogForm=$("#dialogForm"),$btnClose=$dialogForm.children(".topic").children(".btn-close-dialog"),$btnCreate=$("#btnCreate"),$btnSubmit=$("#btnSubmit"),$formProgress=$("#formProgress"),$nameinput=$("#name"),$(".status-items").click(function(){var t=$(this).attr("data-state");$.ajax({url:api_activity,cache:!1,dataType:"json",type:"POST",data:{request:"change_state",activity_id:a,state:t},error:function(t){console.log("Request Error",t.responseText)}}).done(function(t){console.log(t),location.reload()})}),$btnSave=$("#btnSave"),$btnSave.click(function(){$btnSave.addClass("loading");var t=$("#activity_id").val(),e=$("#activity_name").val(),a=$("#activity_desc").val();$progressbar.fadeIn(300),$progressbar.width("0%"),$.ajax({url:api_activity,cache:!1,dataType:"json",type:"POST",data:{request:"edit",activity_id:t,activity_name:e,activity_desc:a},error:function(t){console.log("Request Error",t.responseText)}}).done(function(e){console.log(e),$progressbar.animate({width:"100%"},500),$progressbar.fadeOut(function(){setTimeout(function(){window.location="activity/"+t},1e3)})})}),$("#name").keyup(function(){var t=$(this).val();t.length>1?$btnSubmit.removeClass("disabled"):$btnSubmit.addClass("disabled"),$("#counter").html(t.length)}),$btnSubmit.click(function(){$dialogForm.submit()}),$dialogForm.ajaxForm({beforeSubmit:function(){$formProgress.fadeIn(100),$formProgress.width("0%"),$btnSubmit.prop("disabled",!0),$btnSubmit.addClass("loading"),$btnSubmit.html("กำลังบันทึก")},uploadProgress:function(t,e,a,o){var i=o;i=80*i/100,$formProgress.animate({width:i+"%"},100)},success:function(){$formProgress.animate({width:"90%"},300)},complete:function(t){$formProgress.animate({width:"100%"},300),console.log(t.responseText),console.log(t.responseJSON),setTimeout(function(){location.reload()},1e3)}}),$btnCreate.click(function(){$dialogForm.addClass("open"),$overlay.addClass("open")}),$btnClose.click(function(){$dialogForm.removeClass("open"),$overlay.removeClass("open"),$("#activity_id").val(""),$("#name").val(""),$("#desc").val(""),$("#url").val("")}),$(".edit").click(function(o){o.stopPropagation(),a=$(this).parent().attr("data-id"),e=$(this).parent().children(".detail").children("h2").html(),t(),$submenu=$(this).children(".edit-menu"),$submenu.show()}),$(".edit").on("click",".btn-editor",function(){console.log("activity_id"+a),$.ajax({url:api_activity,cache:!1,dataType:"json",type:"GET",data:{request:"get",activity_id:a},error:function(t){console.log("Request Error",t.responseText)}}).done(function(e){console.log(e),$("#activity_id").val(e.data.activity_id),$("#name").val(e.data.activity_name),$("#desc").val(e.data.project_description),$dialogForm.addClass("open"),$overlay.addClass("open"),t()})}),$(".btn-delete").click(function(){return confirm('คุณต้องการลบ "'+e+'"ใช่หรือไม่ ?')?($.ajax({url:api_activity,cache:!1,dataType:"json",type:"POST",data:{request:"delete",activity_id:a},error:function(t){console.log("Request Error",t.responseText)}}).done(function(t){console.log(t),location.reload()}),void 0):!1}),$(document).click(function(e){$(e.target).closest(".edit-menu").length&&$(e.target).closest(".category-menu").length||t()})});